# ميزة البحث المتقدم للمستخدمين

## نظرة عامة
تم تطوير صفحة بحث متقدمة للمستخدمين في تطبيق سجلي مع دعم كامل للبحث العربي المتقدم.

## الميزات الرئيسية

### 1. البحث العربي المتقدم
- **تطبيع الألف**: يتعامل مع جميع أشكال الألف (أ، إ، آ، ء) كحرف واحد
- **تطبيع الياء**: يتعامل مع (ى، ئ) كحرف ياء واحد
- **تطبيع الهاء والتاء المربوطة**: يتعامل مع (ة، ه) كحرف واحد
- **تطبيع الألقاب**: يتعامل مع "الشيخ" و "شيخ" كنفس الكلمة، وكذلك "السيد" و "سيد"

### 2. البحث في حقول متعددة
- **الاسم الظاهر**: البحث في اسم المستخدم الكامل
- **اسم المستخدم**: البحث في username
- **السيرة الذاتية**: البحث في نص السيرة الذاتية للمستخدم

### 3. واجهة مستخدم متقدمة
- **بحث فوري**: البحث يتم أثناء الكتابة مع تأخير 500ms لتجنب الطلبات المفرطة
- **مؤشر التحميل**: عرض مؤشر أثناء البحث
- **حالات فارغة**: رسائل واضحة عند عدم وجود نتائج أو عدم البحث
- **تصميم متجاوب**: تصميم جميل ومتوافق مع باقي التطبيق

## الملفات المضافة/المحدثة

### 1. `lib/utils/arabic_search_utils.dart`
ملف جديد يحتوي على دوال تطبيع النص العربي:
- `normalizeArabicText()`: تطبيع النص العربي
- `matchesArabicSearch()`: مطابقة البحث مع التطبيع
- `searchInUserFields()`: البحث في حقول المستخدم المتعددة

### 2. `lib/screens/main_screen.dart`
تم تحديث صفحة البحث من صفحة بسيطة إلى صفحة متقدمة:
- إضافة `SearchScreen` كـ StatefulWidget
- إضافة منطق البحث مع PocketBase
- إضافة واجهة مستخدم متقدمة
- إضافة التنقل إلى صفحات المستخدمين

### 3. `test/arabic_search_test.dart`
ملف اختبارات شامل للتأكد من صحة وظائف البحث العربي:
- اختبار تطبيع الألف والياء والهاء
- اختبار تطبيع الألقاب
- اختبار البحث في حقول متعددة
- اختبار التعامل مع النصوص الفارغة

## أمثلة على البحث

### البحث بالألف المختلفة
- البحث عن "احمد" يجد "أحمد" و "إحمد" و "آحمد"
- البحث عن "ابراهيم" يجد "إبراهيم"

### البحث بالياء والألف المقصورة
- البحث عن "علي" يجد "على"
- البحث عن "مصطفي" يجد "مصطفى"

### البحث بالتاء المربوطة والهاء
- البحث عن "فاطمه" يجد "فاطمة"
- البحث عن "عايشه" يجد "عائشة"

### البحث بالألقاب
- البحث عن "شيخ احمد" يجد "الشيخ أحمد"
- البحث عن "سيد محمد" يجد "السيد محمد"

## كيفية الاستخدام

1. افتح التطبيق وانتقل إلى تبويب "البحث"
2. اكتب اسم المستخدم أو الاسم الظاهر في حقل البحث
3. ستظهر النتائج تلقائياً أثناء الكتابة
4. اضغط على أي مستخدم للانتقال إلى صفحته الشخصية

## التقنيات المستخدمة

- **Flutter**: إطار العمل الأساسي
- **PocketBase**: قاعدة البيانات والبحث الخلفي
- **Dart RegExp**: للتعامل مع التشكيل العربي
- **Flutter Test**: لاختبار الوظائف

## الاختبارات

تم إنشاء مجموعة شاملة من الاختبارات في `test/arabic_search_test.dart`:

```bash
flutter test test/arabic_search_test.dart
```

جميع الاختبارات تمر بنجاح (9/9 اختبارات).

## المتطلبات

- Flutter SDK 3.9.0 أو أحدث
- اتصال بالإنترنت للبحث في قاعدة البيانات
- حساب مستخدم مسجل في التطبيق

## ملاحظات للمطورين

- البحث يتم أولاً في قاعدة البيانات باستخدام PocketBase
- ثم يتم تطبيق التطبيع العربي محلياً لتحسين النتائج
- يمكن توسيع دالة `normalizeArabicText()` لإضافة المزيد من قواعد التطبيع
- التأخير في البحث (500ms) يمكن تعديله حسب الحاجة
